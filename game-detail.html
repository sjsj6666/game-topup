<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>åŸç¥å……å€¼ - GameTopUp</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --primary-color: #6C63FF;
      --secondary-color: #FF6584;
      --accent-color: #36D1DC;
      --dark-color: #1A1A2E;
      --light-color: #F8F9FA;
      --success-color: #28A745;
      --warning-color: #FFC107;
      --text-dark: #333;
      --text-light: #666;
      --text-muted: #999;
      --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
      --shadow-lg: 0 10px 20px rgba(0,0,0,0.1);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background-color: var(--light-color);
      color: var(--text-dark);
      line-height: 1.6;
      padding-bottom: 80px;
    }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 15px; }

    /* è¿”å›æŒ‰é’® */
    .back-header {
      background: white;
      padding: 15px 0;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: var(--shadow-sm);
    }
    .back-btn {
      display: flex;
      align-items: center;
      gap: 10px;
      background: none;
      border: none;
      font-size: 16px;
      color: var(--text-dark);
      cursor: pointer;
      padding: 8px 16px;
      border-radius: var(--radius-sm);
      transition: background-color 0.3s;
    }
    .back-btn:hover { background-color: #f0f0f0; }

    /* æ¸¸æˆå¤´å›¾ */
    .game-hero {
      position: relative;
      height: 300px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      overflow: hidden;
      margin-bottom: -50px;
    }
    .game-hero-content {
      position: absolute;
      bottom: 30px;
      left: 20px;
      right: 20px;
      color: white;
      z-index: 2;
    }
    .game-hero-title {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 5px;
    }
    .game-hero-subtitle {
      font-size: 1rem;
      opacity: 0.9;
      margin-bottom: 15px;
    }
    .game-hero-rating {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .rating-stars { color: #FFD700; }
    .download-count { font-size: 0.9rem; opacity: 0.8; }
    .game-hero-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 100px;
      background: linear-gradient(to top, rgba(0,0,0,0.5), transparent);
      z-index: 1;
    }

    /* æ¸¸æˆä¿¡æ¯å¡ç‰‡ */
    .game-info-card {
      background: white;
      border-radius: var(--radius-lg);
      padding: 20px;
      margin: 20px;
      box-shadow: var(--shadow-md);
      position: relative;
      z-index: 3;
    }
    .game-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 15px;
    }
    .game-tag {
      background: #f0f0f0;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      color: var(--text-light);
    }
    .game-tag.hot {
      background: #ffeaea;
      color: var(--secondary-color);
    }
    .game-description {
      margin-bottom: 20px;
      color: var(--text-light);
      line-height: 1.8;
    }

    /* å……å€¼å¥—é¤åŒº */
    .packages-section { margin: 20px; }
    .section-title {
      font-size: 1.4rem;
      font-weight: 600;
      margin-bottom: 15px;
      color: var(--text-dark);
    }
    .package-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .package-item {
      background: white;
      border-radius: var(--radius-md);
      padding: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: var(--shadow-sm);
      cursor: pointer;
      transition: all 0.3s;
      border: 2px solid transparent;
    }
    .package-item:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }
    .package-item.selected {
      border-color: var(--primary-color);
      background-color: rgba(108, 99, 255, 0.05);
    }
    .package-left { flex: 1; }
    .package-title {
      font-weight: 600;
      margin-bottom: 5px;
    }
    .package-desc {
      font-size: 0.9rem;
      color: var(--text-light);
    }
    .package-right { text-align: right; }
    .package-price {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary-color);
    }
    .package-original {
      font-size: 0.9rem;
      color: var(--text-muted);
      text-decoration: line-through;
    }
    .package-badge {
      display: inline-block;
      background: var(--secondary-color);
      color: white;
      padding: 2px 8px;
      border-radius: var(--radius-sm);
      font-size: 0.7rem;
      margin-left: 5px;
    }

    /* æ•°é‡é€‰æ‹© */
    .quantity-section {
      margin: 20px;
      background: white;
      border-radius: var(--radius-md);
      padding: 15px;
      box-shadow: var(--shadow-sm);
    }
    .quantity-control {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 15px;
    }
    .quantity-label { font-weight: 500; }
    .quantity-input {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .quantity-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 1px solid #ddd;
      background: white;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }
    .quantity-btn:hover { background: #f5f5f5; }
    .quantity-value {
      font-size: 1.2rem;
      font-weight: 600;
      min-width: 40px;
      text-align: center;
    }

    /* æ€»è®¡ */
    .total-section {
      margin: 20px;
      background: white;
      border-radius: var(--radius-md);
      padding: 15px;
      box-shadow: var(--shadow-sm);
    }
    .total-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .total-label { color: var(--text-light); }
    .total-value { font-weight: 600; }
    .total-final {
      border-top: 1px solid #eee;
      padding-top: 10px;
      margin-top: 10px;
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary-color);
    }

    /* æ”¯ä»˜æ–¹å¼ */
    .payment-section { margin: 20px; }
    .payment-methods {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 15px;
    }
    .payment-method {
      background: white;
      border-radius: var(--radius-sm);
      padding: 15px;
      text-align: center;
      border: 2px solid #eee;
      cursor: pointer;
      transition: all 0.3s;
    }
    .payment-method:hover { border-color: var(--primary-color); }
    .payment-method.selected {
      border-color: var(--primary-color);
      background-color: rgba(108, 99, 255, 0.05);
    }
    .payment-icon {
      font-size: 1.5rem;
      margin-bottom: 8px;
    }
    .payment-name {
      font-size: 0.9rem;
      color: var(--text-dark);
    }

    /* ç”¨æˆ·è¯„ä»· */
    .reviews-section { margin: 20px; }
    .review-list { margin-top: 15px; }
    .review-item {
      background: white;
      border-radius: var(--radius-md);
      padding: 15px;
      margin-bottom: 12px;
      box-shadow: var(--shadow-sm);
    }
    .review-header {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
    .review-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      margin-right: 10px;
    }
    .review-info { flex: 1; }
    .review-name { font-weight: 600; margin-bottom: 2px; }
    .review-date { font-size: 0.8rem; color: var(--text-muted); }
    .review-stars { color: #FFD700; font-size: 0.9rem; }
    .review-content {
      color: var(--text-light);
      line-height: 1.6;
    }

    /* å›ºå®šåº•éƒ¨æŒ‰é’® */
    .action-footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      padding: 15px 20px;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      z-index: 1000;
      display: flex;
      gap: 15px;
    }
    .action-btn {
      flex: 1;
      padding: 15px;
      border-radius: var(--radius-lg);
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .btn-cart {
      background: #f8f9fa;
      color: var(--text-dark);
      border: 1px solid #ddd;
    }
    .btn-cart:hover { background: #e9ecef; }
    .btn-buy {
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      color: white;
      box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3);
    }
    .btn-buy:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(108, 99, 255, 0.4);
    }

    /* å“åº”å¼è°ƒæ•´ */
    @media (min-width: 768px) {
      .container {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
        padding: 20px;
      }
      .main-content { grid-column: 1; }
      .sidebar { grid-column: 2; }
      .game-hero {
        height: 400px;
        border-radius: var(--radius-lg);
        margin: 20px 20px -100px 20px;
      }
      .game-info-card,
      .packages-section,
      .quantity-section,
      .total-section,
      .payment-section,
      .reviews-section {
        margin: 0 0 20px 0;
      }
      .action-footer { display: none; }
      .desktop-actions {
        display: block;
        position: sticky;
        top: 100px;
      }
    }
    .desktop-actions { display: none; }
  </style>
</head>
<body>
  <!-- è¿”å›å¤´éƒ¨ -->
  <header class="back-header">
    <div class="container">
      <button class="back-btn" id="backBtn">
        <i class="fas fa-arrow-left"></i> è¿”å›é¦–é¡µ
      </button>
    </div>
  </header>

  <!-- æ¸¸æˆå¤´å›¾ -->
  <section class="game-hero">
    <div class="game-hero-content">
      <h1 class="game-hero-title">åŸç¥ Genshin Impact</h1>
      <p class="game-hero-subtitle">å¼€æ”¾ä¸–ç•Œå†’é™© RPG</p>
      <div class="game-hero-rating">
        <div class="rating-stars">
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star"></i>
          <i class="fas fa-star-half-alt"></i>
        </div>
        <span class="download-count">200 ä¸‡ + ç©å®¶é€‰æ‹©</span>
      </div>
    </div>
    <div class="game-hero-overlay"></div>
  </section>

  <div class="container">
    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-content">
      <!-- æ¸¸æˆä¿¡æ¯å¡ç‰‡ -->
      <div class="game-info-card">
        <div class="game-tags">
          <span class="game-tag hot">ğŸ”¥ æ–°å¹´ç‰¹æƒ </span>
          <span class="game-tag">å¼€æ”¾ä¸–ç•Œ</span>
          <span class="game-tag">è§’è‰²æ‰®æ¼”</span>
          <span class="game-tag">å¤šå¹³å°</span>
        </div>
        <div class="game-description">
          åœ¨æç“¦ç‰¹å¤§é™†çš„å¥‡å¹»ä¸–ç•Œä¸­å±•å¼€å†’é™©ã€‚æ¢ç´¢å¹¿é˜”çš„ä¸–ç•Œï¼Œç»„å»ºå¼ºå¤§çš„è§’è‰²é˜Ÿä¼ï¼Œä½“éªŒå²è¯—çº§çš„å‰§æƒ…æ•…äº‹ã€‚ç°åœ¨å……å€¼åˆ›ä¸–ç»“æ™¶å¯äº«å—æ–°å¹´ç‰¹åˆ«ä¼˜æƒ ï¼Œæ›´æœ‰é¢å¤–åŸçŸ³èµ é€ï¼
        </div>
        <div class="game-features">
          <div style="display: flex; align-items: center; margin-bottom: 10px;">
            <i class="fas fa-check-circle" style="color: var(--success-color); margin-right: 8px;"></i>
            <span>å®˜æ–¹æ¸ é“ å®‰å…¨é è°±</span>
          </div>
          <div style="display: flex; align-items: center; margin-bottom: 10px;">
            <i class="fas fa-check-circle" style="color: var(--success-color); margin-right: 8px;"></i>
            <span>ç§’é€Ÿåˆ°è´¦ æ— éœ€ç­‰å¾…</span>
          </div>
          <div style="display: flex; align-items: center;">
            <i class="fas fa-check-circle" style="color: var(--success-color); margin-right: 8px;"></i>
            <span>7Ã—24 å°æ—¶ å®¢æœæ”¯æŒ</span>
          </div>
        </div>
      </div>

      <!-- å……å€¼å¥—é¤ -->
      <div class="packages-section">
        <h2 class="section-title">ğŸ’° å……å€¼å¥—é¤</h2>
        <div class="package-list" id="packageList">
          <!-- å¥—é¤å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
        </div>
      </div>

      <!-- æ•°é‡é€‰æ‹© -->
      <div class="quantity-section">
        <div class="quantity-control">
          <div class="quantity-label">è´­ä¹°æ•°é‡</div>
          <div class="quantity-input">
            <button class="quantity-btn" id="quantityMinus">-</button>
            <span class="quantity-value" id="quantityValue">1</span>
            <button class="quantity-btn" id="quantityPlus">+</button>
          </div>
        </div>
        <div style="font-size: 0.9rem; color: var(--text-light);">
          æ³¨ï¼šéƒ¨åˆ†å¥—é¤æœ‰è´­ä¹°æ•°é‡é™åˆ¶
        </div>
      </div>

      <!-- ç”¨æˆ·è¯„ä»· -->
      <div class="reviews-section">
        <h2 class="section-title">â­ ç”¨æˆ·è¯„ä»·</h2>
        <div class="review-list">
          <!-- è¯„ä»·å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
        </div>
      </div>
    </div>

    <!-- ä¾§è¾¹æ ï¼ˆæ¡Œé¢ç«¯ï¼‰ -->
    <div class="sidebar">
      <!-- æ€»è®¡ -->
      <div class="total-section desktop-actions">
        <div class="total-row">
          <span class="total-label">å¥—é¤å•ä»·</span>
          <span class="total-value" id="totalPackage">Â¥6.00</span>
        </div>
        <div class="total-row">
          <span class="total-label">è´­ä¹°æ•°é‡</span>
          <span class="total-value" id="totalQuantity">Ã—1</span>
        </div>
        <div class="total-row">
          <span class="total-label">ä¼˜æƒ æŠ˜æ‰£</span>
          <span class="total-value" id="totalDiscount">-Â¥0.00</span>
        </div>
        <div class="total-row total-final">
          <span>åº”ä»˜æ€»é¢</span>
          <span id="totalAmount">Â¥6.00</span>
        </div>

        <!-- æ”¯ä»˜æ–¹å¼ -->
        <div style="margin-top: 20px;">
          <div class="section-title" style="font-size: 1.1rem;">æ”¯ä»˜æ–¹å¼</div>
          <div class="payment-methods">
            <div class="payment-method selected" data-method="alipay">
              <div class="payment-icon"><i class="fab fa-alipay"></i></div>
              <div class="payment-name">æ”¯ä»˜å®</div>
            </div>
            <div class="payment-method" data-method="wechat">
              <div class="payment-icon"><i class="fab fa-weixin"></i></div>
              <div class="payment-name">å¾®ä¿¡æ”¯ä»˜</div>
            </div>
            <div class="payment-method" data-method="paypal">
              <div class="payment-icon"><i class="fab fa-paypal"></i></div>
              <div class="payment-name">PayPal</div>
            </div>
          </div>
        </div>

        <!-- æ¡Œé¢ç«¯æ“ä½œæŒ‰é’® -->
        <div style="margin-top: 25px; display: flex; gap: 10px;">
          <button class="action-btn btn-cart desktop-only" id="desktopCartBtn">
            <i class="fas fa-shopping-cart"></i> åŠ å…¥è´­ç‰©è½¦
          </button>
          <button class="action-btn btn-buy desktop-only" id="desktopBuyBtn">
            <i class="fas fa-bolt"></i> ç«‹å³è´­ä¹°
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ç§»åŠ¨ç«¯åº•éƒ¨æ“ä½œæ  -->
  <div class="action-footer">
    <button class="action-btn btn-cart" id="mobileCartBtn">
      <i class="fas fa-shopping-cart"></i> åŠ å…¥è´­ç‰©è½¦
    </button>
    <button class="action-btn btn-buy" id="mobileBuyBtn">
      <i class="fas fa-bolt"></i> ç«‹å³è´­ä¹°
    </button>
  </div>

  <script>
    // ğŸ® æ¸¸æˆæ•°æ®
    const gamePackages = [
      { id: 1, name: "60 åˆ›ä¸–ç»“æ™¶", description: "é¦–å……åŒå€ï¼Œæ€§ä»·æ¯”ä¹‹é€‰", price: 6, originalPrice: 6, discount: 0, recommend: false },
      { id: 2, name: "300 åˆ›ä¸–ç»“æ™¶", description: "æœˆå¡è¡¥å……ï¼Œæ—¥å¸¸å¿…å¤‡", price: 30, originalPrice: 30, discount: 0, recommend: false },
      { id: 3, name: "980 åˆ›ä¸–ç»“æ™¶", description: "è§’è‰²æŠ½å–ï¼Œå¿ƒæ„¿å•é¦–é€‰", price: 98, originalPrice: 98, discount: 0, recommend: true },
      { id: 4, name: "1980 åˆ›ä¸–ç»“æ™¶", description: "æ­¦å™¨é”»é€ ï¼Œè¿›é˜¶ä¹‹é€‰", price: 198, originalPrice: 198, discount: 0, recommend: true },
      { id: 5, name: "3280 åˆ›ä¸–ç»“æ™¶", description: "å¤§é¢å……å€¼ï¼Œæœ€å—æ¬¢è¿", price: 328, originalPrice: 328, discount: 0, recommend: true },
      { id: 6, name: "6480 åˆ›ä¸–ç»“æ™¶", description: "é™æ—¶ç‰¹æƒ ï¼Œé€ 1600 åŸçŸ³", price: 648, originalPrice: 864, discount: 216, badge: "25% OFF", recommend: true }
    ];

    // ç”¨æˆ·è¯„ä»·æ•°æ®
    const userReviews = [
      { name: "æ—…è¡Œè€… A", date: "2026-02-18", rating: 5, content: "å……å€¼ç§’åˆ°è´¦ï¼Œè¿˜æœ‰é¢å¤–åŸçŸ³èµ é€ï¼Œå¤ªåˆ’ç®—äº†ï¼å·²ç»ç¬¬äºŒæ¬¡è´­ä¹°äº†ï¼ŒæœåŠ¡å¾ˆç¨³å®šã€‚" },
      { name: "åˆ»æ™´çœŸçˆ±å…š", date: "2026-02-15", rating: 5, content: "ä¸ºäº†æŠ½åˆ»æ™´çš„ä¸“æ­¦ï¼Œä¹°äº† 6480 å¥—é¤ï¼ŒçœŸçš„æ¯”å®˜æ–¹å……å€¼ä¾¿å®œå¾ˆå¤šï¼Œæ”¯æŒï¼" },
      { name: "æ–°æ‰‹ç©å®¶ B", date: "2026-02-10", rating: 4, content: "ç¬¬ä¸€æ¬¡åœ¨ç¬¬ä¸‰æ–¹å¹³å°å……å€¼ï¼Œè¿˜æœ‰ç‚¹æ‹…å¿ƒï¼Œä½†ä½“éªŒå¾ˆå¥½ï¼Œ5 åˆ†é’Ÿå°±åˆ°è´¦äº†ã€‚" },
      { name: "èµ„æ·±ç©å®¶ C", date: "2026-02-05", rating: 5, content: "é•¿æœŸåœ¨è¿™é‡Œå……å€¼ï¼Œæ¯”å…¶ä»–å¹³å°é è°±ï¼Œå®¢æœå›å¤ä¹ŸåŠæ—¶ï¼Œæ¨èç»™æœ‹å‹äº†ã€‚" }
    ];

    // è´­ç‰©è½¦å’Œè®¢å•æ•°æ®
    let selectedPackage = null;
    let quantity = 1;
    let paymentMethod = "alipay";

    // DOM å…ƒç´ ï¼ˆæ·»åŠ ç©ºå€¼æ£€æŸ¥ï¼‰
    const backBtn = document.getElementById('backBtn');
    const packageList = document.getElementById('packageList');
    const quantityValue = document.getElementById('quantityValue');
    const quantityMinus = document.getElementById('quantityMinus');
    const quantityPlus = document.getElementById('quantityPlus');
    const totalPackage = document.getElementById('totalPackage');
    const totalQuantity = document.getElementById('totalQuantity');
    const totalDiscount = document.getElementById('totalDiscount');
    const totalAmount = document.getElementById('totalAmount');
    const mobileCartBtn = document.getElementById('mobileCartBtn');
    const mobileBuyBtn = document.getElementById('mobileBuyBtn');
    const desktopCartBtn = document.getElementById('desktopCartBtn');
    const desktopBuyBtn = document.getElementById('desktopBuyBtn');

    // ğŸ”§ å®‰å…¨è·å– localStorageï¼ˆä¿®å¤ file:// åè®®é—®é¢˜ï¼‰
    function safeGetStorage(key, defaultValue) {
      try {
        const item = localStorage.getItem(key);
        return item ? JSON.parse(item) : defaultValue;
      } catch (e) {
        console.warn('localStorage ä¸å¯ç”¨ï¼Œä½¿ç”¨å†…å­˜å­˜å‚¨', e);
        return defaultValue;
      }
    }

    function safeSetStorage(key, value) {
      try {
        localStorage.setItem(key, JSON.stringify(value));
        return true;
      } catch (e) {
        console.warn('localStorage ä¿å­˜å¤±è´¥', e);
        alert('âš ï¸ æ³¨æ„ï¼šç”±äºæµè§ˆå™¨é™åˆ¶ï¼Œè´­ç‰©è½¦æ•°æ®å¯èƒ½æ— æ³•ä¿å­˜ã€‚å»ºè®®ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨è¿è¡Œã€‚');
        return false;
      }
    }

    // åˆå§‹åŒ–é¡µé¢
    function initPage() {
      console.log('ğŸ”§ é¡µé¢åˆå§‹åŒ–å¼€å§‹...');
      renderPackages();
      renderReviews();
      if (gamePackages.length > 0) selectPackage(gamePackages[0]);
      initPaymentMethods();
      updateOrderTotal();
      console.log('âœ… é¡µé¢åˆå§‹åŒ–å®Œæˆ');
    }

    // æ¸²æŸ“å¥—é¤åˆ—è¡¨
    function renderPackages() {
      if (!packageList) {
        console.error('âŒ packageList å…ƒç´ æœªæ‰¾åˆ°');
        return;
      }
      packageList.innerHTML = '';
      gamePackages.forEach(pkg => {
        const packageItem = document.createElement('div');
        packageItem.className = 'package-item';
        packageItem.dataset.id = pkg.id;
        let badgeHtml = pkg.badge ? `<span class="package-badge">${pkg.badge}</span>` : '';
        let recommendHtml = pkg.recommend ? '<div style="font-size: 0.8rem; color: var(--secondary-color); margin-top: 3px;">ğŸ”¥ æ¨è</div>' : '';
        let originalPriceHtml = pkg.discount > 0 ? `<div class="package-original">Â¥${pkg.originalPrice.toFixed(2)}</div>` : '';
        
        packageItem.innerHTML = `
          <div class="package-left">
            <div class="package-title">${pkg.name}</div>
            <div class="package-desc">${pkg.description}</div>
            ${recommendHtml}
          </div>
          <div class="package-right">
            <div class="package-price">Â¥${pkg.price.toFixed(2)}</div>
            ${originalPriceHtml}
            ${badgeHtml}
          </div>
        `;
        packageItem.addEventListener('click', () => selectPackage(pkg));
        packageList.appendChild(packageItem);
      });
    }

    // é€‰æ‹©å¥—é¤
    function selectPackage(pkg) {
      selectedPackage = pkg;
      document.querySelectorAll('.package-item').forEach(item => {
        item.classList.remove('selected');
        if (parseInt(item.dataset.id) === pkg.id) item.classList.add('selected');
      });
      updateOrderTotal();
    }

    // æ¸²æŸ“ç”¨æˆ·è¯„ä»·
    function renderReviews() {
      const reviewList = document.querySelector('.review-list');
      if (!reviewList) return;
      reviewList.innerHTML = '';
      userReviews.forEach(review => {
        const reviewItem = document.createElement('div');
        reviewItem.className = 'review-item';
        let starsHtml = '';
        for (let i = 0; i < 5; i++) {
          if (i < Math.floor(review.rating)) starsHtml += '<i class="fas fa-star"></i>';
          else if (i === Math.floor(review.rating) && review.rating % 1 !== 0) starsHtml += '<i class="fas fa-star-half-alt"></i>';
          else starsHtml += '<i class="far fa-star"></i>';
        }
        const avatarLetter = review.name.charAt(0);
        reviewItem.innerHTML = `
          <div class="review-header">
            <div class="review-avatar">${avatarLetter}</div>
            <div class="review-info">
              <div class="review-name">${review.name}</div>
              <div class="review-date">${review.date}</div>
            </div>
            <div class="review-stars">${starsHtml}</div>
          </div>
          <div class="review-content">${review.content}</div>
        `;
        reviewList.appendChild(reviewItem);
      });
    }

    // åˆå§‹åŒ–æ”¯ä»˜æ–¹å¼
    function initPaymentMethods() {
      const paymentMethods = document.querySelectorAll('.payment-method');
      paymentMethods.forEach(method => {
        method.addEventListener('click', () => {
          paymentMethods.forEach(m => m.classList.remove('selected'));
          method.classList.add('selected');
          paymentMethod = method.dataset.method;
        });
      });
    }

    // æ›´æ–°è®¢å•æ€»è®¡
    function updateOrderTotal() {
      if (!selectedPackage) return;
      const packagePrice = selectedPackage.price;
      const originalPrice = selectedPackage.originalPrice || packagePrice;
      const discount = originalPrice - packagePrice;
      const total = packagePrice * quantity;
      const totalDiscountAmount = discount * quantity;
      
      if (totalPackage) totalPackage.textContent = `Â¥${packagePrice.toFixed(2)}`;
      if (totalQuantity) totalQuantity.textContent = `Ã—${quantity}`;
      if (totalDiscount) totalDiscount.textContent = `-Â¥${totalDiscountAmount.toFixed(2)}`;
      if (totalAmount) totalAmount.textContent = `Â¥${total.toFixed(2)}`;
    }

    // ğŸ”™ è¿”å›æŒ‰é’®åŠŸèƒ½ï¼ˆä¿®å¤ï¼šç›´æ¥è·³è½¬ index.htmlï¼‰
    if (backBtn) {
      backBtn.addEventListener('click', () => {
        // å…ˆå°è¯• history.back()
        if (window.history.length > 1) {
          window.history.back();
        } else {
          // å¦‚æœæ— å†å²è®°å½•ï¼Œç›´æ¥è·³è½¬é¦–é¡µ
          window.location.href = 'index.html';
        }
      });
    }

    // æ•°é‡æ§åˆ¶
    if (quantityMinus) {
      quantityMinus.addEventListener('click', () => {
        if (quantity > 1) { quantity--; if(quantityValue) quantityValue.textContent = quantity; updateOrderTotal(); }
      });
    }
    if (quantityPlus) {
      quantityPlus.addEventListener('click', () => {
        quantity++; if(quantityValue) quantityValue.textContent = quantity; updateOrderTotal();
      });
    }

    // ğŸ›’ åŠ å…¥è´­ç‰©è½¦åŠŸèƒ½ï¼ˆä¿®å¤ localStorage é—®é¢˜ï¼‰
    function addToCart() {
      if (!selectedPackage) { 
        alert('âš ï¸ è¯·å…ˆé€‰æ‹©å……å€¼å¥—é¤'); 
        return; 
      }
      const cartItem = {
        game: 'åŸç¥ Genshin Impact',
        package: selectedPackage,
        quantity: quantity,
        paymentMethod: paymentMethod,
        total: selectedPackage.price * quantity
      };
      
      let cart = safeGetStorage('gameTopUpCart', []);
      cart.push(cartItem);
      const success = safeSetStorage('gameTopUpCart', cart);
      
      if (success) {
        showNotification('âœ… å·²æˆåŠŸæ·»åŠ åˆ°è´­ç‰©è½¦ï¼');
        // æ›´æ–°ä¸»é¡µè´­ç‰©è½¦è§’æ ‡
        let cartCount = safeGetStorage('gameTopUpCartCount', 0);
        safeSetStorage('gameTopUpCartCount', cartCount + 1);
      }
    }

    // ğŸ’³ ç«‹å³è´­ä¹°åŠŸèƒ½
    function buyNow() {
      if (!selectedPackage) { 
        alert('âš ï¸ è¯·å…ˆé€‰æ‹©å……å€¼å¥—é¤'); 
        return; 
      }
      const orderData = {
        game: 'åŸç¥ Genshin Impact',
        package: selectedPackage,
        quantity: quantity,
        paymentMethod: paymentMethod,
        total: selectedPackage.price * quantity,
        orderId: 'ORD' + Date.now(),
        date: new Date().toISOString()
      };
      
      let orders = safeGetStorage('gameTopUpOrders', []);
      orders.push(orderData);
      safeSetStorage('gameTopUpOrders', orders);
      
      alert(`ğŸ‰ è®¢å•åˆ›å»ºæˆåŠŸï¼\nè®¢å•å·ï¼š${orderData.orderId}\né‡‘é¢ï¼šÂ¥${orderData.total.toFixed(2)}\n\nï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼šä¸ä¼šçœŸæ­£æ‰£æ¬¾ï¼‰`);
    }

    // æ˜¾ç¤ºé€šçŸ¥
    function showNotification(message) {
      const notification = document.createElement('div');
      notification.textContent = message;
      notification.style.cssText = `
        position: fixed; top: 100px; left: 50%; transform: translateX(-50%);
        background-color: var(--success-color); color: white;
        padding: 12px 24px; border-radius: 30px; z-index: 2000;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2); animation: slideIn 0.3s ease-out;
      `;
      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideIn { from { top: 80px; opacity: 0; } to { top: 100px; opacity: 1; } }
        @keyframes slideOut { from { top: 100px; opacity: 1; } to { top: 80px; opacity: 0; } }
      `;
      document.head.appendChild(style);
      document.body.appendChild(notification);
      setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease-out forwards';
        setTimeout(() => { if (notification.parentNode) notification.remove(); }, 300);
      }, 2000);
    }

    // ç»‘å®šæŒ‰é’®äº‹ä»¶ï¼ˆæ·»åŠ ç©ºå€¼æ£€æŸ¥ï¼‰
    if (mobileCartBtn) mobileCartBtn.addEventListener('click', addToCart);
    if (mobileBuyBtn) mobileBuyBtn.addEventListener('click', buyNow);
    if (desktopCartBtn) desktopCartBtn.addEventListener('click', addToCart);
    if (desktopBuyBtn) desktopBuyBtn.addEventListener('click', buyNow);

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', initPage);

    // ğŸ‰ è°ƒè¯•ä¿¡æ¯
    console.log('ğŸ® æ¬¢è¿æ¥åˆ°åŸç¥å……å€¼é¡µé¢ï¼');
    console.log('ğŸ”§ å¦‚æœåŠŸèƒ½ä¸å·¥ä½œï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ä¿¡æ¯');
    console.log('ğŸ“± å»ºè®®ä½¿ç”¨ Acode æœ¬åœ°æœåŠ¡å™¨è¿è¡Œï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰“å¼€ file://');
  </script>
</body>
</html>